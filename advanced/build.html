<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Library Building &mdash; Scalable Vector Search 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/sphinx_collapse.css?v=226d88b4" />
      <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=d45e8c67"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Graph-based similarity search" href="graph_search.html" />
    <link rel="prev" title="Searching with a small memory footprint" href="lowermem.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Scalable Vector Search
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start.html">Getting started with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start_cpp.html">Getting started with C++</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Library Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howtos.html">How-Tos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../io.html">I/O and Conversion Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance/index.html">Performance Tuning</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Advanced Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="lowermem.html">Searching with a small memory footprint</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Library Building</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-python-library">Building Python Library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cibuildwheel-and-microarchitecture-compatibility">CIBuildWheel and Microarchitecture Compatibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="#customizing-wheels">Customizing Wheels</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-notes">Building Notes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#c-build">C++ Build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cmake-support">CMake Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building-utility-binaries">Building Utility Binaries</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#build-options">Build Options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#details-on-multi-arch-support">Details on multi-arch support</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-building-the-documentation">(Advanced) Building the Documentation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#building">Building</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-intel-r-mkl-as-a-dependency">(Advanced) Intel(R) MKL as a Dependency</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="static_dimensionality.html">Static Dimensionality</a></li>
<li class="toctree-l2"><a class="reference internal" href="graph_search.html">Graph-based similarity search</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../benchs/index.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python/common.html">Common Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/loaders.html">Loaders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/flat.html">Flat Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/vamana.html">Vamana Graph Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/dynamic.html">Dynamic Vamana Graph Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/backend.html">Backend Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/upgrader.html">Object Upgrader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python/logging.html">Python Logging API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">C++ Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cpp/top.html">C++ Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/index/index.html">Indexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/core/index.html">Core Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/quantization/index.html">Quantization Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/concepts/index.html">Core Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/internal/index.html">Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cpp/testing.html">Testing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Experimental Python Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../python/experimental/leanvec.html">Using LeanVec</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Scalable Vector Search</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Advanced Topics</a></li>
      <li class="breadcrumb-item active">Library Building</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/advanced/build.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="library-building">
<span id="build"></span><h1>Library Building<a class="headerlink" href="#library-building" title="Link to this heading">ÔÉÅ</a></h1>
<p>The SVS library comes in three main forms:</p>
<blockquote>
<div><ul class="simple">
<li><p>A header only C++ library.</p></li>
<li><p>A small set of command-line utilities for exploring similarity search.</p></li>
<li><p>A Python wheel for interactive use.</p></li>
</ul>
</div></blockquote>
<p>Extensive use of C++20 is used both through-out the SVS library and its dependencies (mainly the <a class="reference external" href="https://github.com/jfalcou/eve">EVE</a> SIMD library).
The minimum tested compilers are</p>
<blockquote>
<div><ul class="simple">
<li><p>GCC 11.0</p></li>
<li><p>Clang 13.0</p></li>
</ul>
</div></blockquote>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#building-python-library" id="id4">Building Python Library</a></p></li>
<li><p><a class="reference internal" href="#c-build" id="id5">C++ Build</a></p></li>
<li><p><a class="reference internal" href="#build-options" id="id6">Build Options</a></p></li>
<li><p><a class="reference internal" href="#advanced-building-the-documentation" id="id7">(Advanced) Building the Documentation</a></p></li>
<li><p><a class="reference internal" href="#advanced-intel-r-mkl-as-a-dependency" id="id8">(Advanced) Intel(R) MKL as a Dependency</a></p></li>
</ul>
</nav>
<section id="building-python-library">
<span id="id1"></span><h2><a class="toc-backref" href="#id4" role="doc-backlink">Building Python Library</a><a class="headerlink" href="#building-python-library" title="Link to this heading">ÔÉÅ</a></h2>
<section id="cibuildwheel-and-microarchitecture-compatibility">
<span id="build-cibuildwheel"></span><h3>CIBuildWheel and Microarchitecture Compatibility<a class="headerlink" href="#cibuildwheel-and-microarchitecture-compatibility" title="Link to this heading">ÔÉÅ</a></h3>
<p>We support building SVS as a Python wheel in a Docker container using <a class="reference external" href="https://cibuildwheel.pypa.io">cibuildwheel</a>.</p>
<p>You need to install cibuildwheel and <a class="reference external" href="https://docs.docker.com/engine/install/">docker</a>.
Once those are installed, navigate to the root directory of the source and run</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># clean any previous build artifacts</span>
rm<span class="w"> </span>-rf<span class="w"> </span>bindings/python/_skbuild
<span class="c1"># build container image</span>
<span class="nb">cd</span><span class="w"> </span>docker/x86_64/manylinux2014
./build.sh
<span class="c1"># build Python wheel</span>
<span class="nb">cd</span><span class="w"> </span>-
cibuildwheel<span class="w"> </span>--only<span class="w"> </span><span class="k">$(</span>python3<span class="w"> </span>tools/pybuild.py<span class="k">)</span><span class="w"> </span>bindings/python
</pre></div>
</div>
<p>If you wish to build wheels for all supported versions of Python, not just the version you are using, leave out <code class="docutils literal notranslate"><span class="pre">--only</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>cibuildwheel<span class="w"> </span>bindings/python
</pre></div>
</div>
<p>The resulting Python wheel will be generated in the <code class="docutils literal notranslate"><span class="pre">wheelhouse</span></code> directory and can be installed from there.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>wheelhouse/scalable_vs*.whl
</pre></div>
</div>
<p>SVS uses C++20 and many Intel(R) AVX-512 hardware features to achieve performance.
However, we still want to support older CPUs and reasonably old Linux distributions that may have some GLIBC limitations.
The wheel built by cibuildwheel has maximum compatibility.</p>
</section>
<section id="customizing-wheels">
<h3>Customizing Wheels<a class="headerlink" href="#customizing-wheels" title="Link to this heading">ÔÉÅ</a></h3>
<p>The following commands will perform the <strong>native</strong> build, with optimizations specific to the CPU you are using:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>bindings/python
python3<span class="w"> </span>setup.py<span class="w"> </span>bdist_wheel<span class="w"> </span>--<span class="w"> </span><span class="o">[</span>cmake<span class="w"> </span>arguments<span class="o">]</span><span class="w"> </span>--<span class="w"> </span>-j<span class="k">$(</span>nproc<span class="k">)</span>
pip<span class="w"> </span>install<span class="w"> </span>./dist/scalable_vs*.whl
</pre></div>
</div>
<p>If the default build options are acceptable, the CMake arguments may be left empty. If you want optimizations for a different CPU than the one you are using for the build, you can specify a microarchitecture using <code class="docutils literal notranslate"><span class="pre">SVS_MICROARCHS</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>setup.py<span class="w"> </span>bdist_wheel<span class="w"> </span>--<span class="w"> </span>-DSVS_MICROARCHS<span class="o">=</span>sapphirerapids<span class="w"> </span>--<span class="w"> </span>-j<span class="k">$(</span>nproc<span class="k">)</span>
</pre></div>
</div>
<section id="debug-builds">
<h4>Debug Builds<a class="headerlink" href="#debug-builds" title="Link to this heading">ÔÉÅ</a></h4>
<p>Every once in a while, it is beneficial to use either a debug build of the Python wheel or at least build the wheel with debug information.
This can be difficult through the pip only approach as it likes to transitively build dependencies.
Instead, it is recommended to go through the two stage approach:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>bindings/python
python3<span class="w"> </span>setup.py<span class="w"> </span>bdist_wheel<span class="w"> </span>--build-type<span class="o">=</span>Debug<span class="w"> </span>--<span class="w"> </span>--<span class="w"> </span>-j<span class="k">$(</span>nproc<span class="k">)</span>
</pre></div>
</div>
</section>
</section>
<section id="building-notes">
<h3>Building Notes<a class="headerlink" href="#building-notes" title="Link to this heading">ÔÉÅ</a></h3>
<p>Occasionally, the Python build process will fail seemingly without cause.
This usually occurs when previously there has been a mix of different compilers, compile-time variables, and build strategies.
If this happens, try removing <code class="docutils literal notranslate"><span class="pre">bindings/python/_skbuild</span></code> and <code class="docutils literal notranslate"><span class="pre">bindings/python/dist</span></code> and going again.</p>
</section>
</section>
<section id="c-build">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">C++ Build</a><a class="headerlink" href="#c-build" title="Link to this heading">ÔÉÅ</a></h2>
<section id="cmake-support">
<span id="cpp-cmake-support"></span><h3>CMake Support<a class="headerlink" href="#cmake-support" title="Link to this heading">ÔÉÅ</a></h3>
<p>SVS provides a cmake target to enable source builds against the library:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">svs::svs</span></code>: Links the code headers and shared library components (if applicable).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">svs::compile_options</span></code>: Compiler flags helpful for building the libary.</p></li>
</ul>
</div></blockquote>
<section id="usage-in-cmake">
<h4>Usage In CMake<a class="headerlink" href="#usage-in-cmake" title="Link to this heading">ÔÉÅ</a></h4>
<p>To include the C++ portion of the library in a CMake based project, follow the template below.</p>
<div class="highlight-cmake notranslate"><div class="highlight"><pre><span></span><span class="nb">include</span><span class="p">(</span><span class="s">FetchContent</span><span class="p">)</span>
<span class="nb">FetchContent_Declare</span><span class="p">(</span>
<span class="w">    </span><span class="s">svs</span>
<span class="w">    </span><span class="s">GIT_REPOSITORY</span><span class="w"> </span><span class="s">https://github.com/intel/ScalableVectorSearch.git</span>
<span class="w">    </span><span class="s">GIT_TAG</span><span class="w"> </span><span class="s">main</span>
<span class="p">)</span>

<span class="nb">FetchContent_MakeAvailable</span><span class="p">(</span><span class="s">svs</span><span class="p">)</span>

<span class="c"># Link with the library</span>
<span class="nb">target_link_libraries</span><span class="p">(</span><span class="s">[my_target]</span><span class="w"> </span><span class="s">PRIVATE|PUBLIC|INTERFACE</span><span class="w"> </span><span class="s">svs::svs</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="installing-locally">
<h4>Installing Locally<a class="headerlink" href="#installing-locally" title="Link to this heading">ÔÉÅ</a></h4>
<p>The C++ library can also be installed locally using CMake‚Äôs installation logic.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>build
<span class="nb">cd</span><span class="w"> </span>build
cmake<span class="w"> </span>..<span class="w"> </span>-DCMAKE_INSTALL_PREFIX<span class="o">=</span>my/directory
cmake<span class="w"> </span>--build<span class="w"> </span>.
cmake<span class="w"> </span>--install<span class="w"> </span>.
</pre></div>
</div>
</section>
</section>
<section id="building-utility-binaries">
<h3>Building Utility Binaries<a class="headerlink" href="#building-utility-binaries" title="Link to this heading">ÔÉÅ</a></h3>
<p>To build the utility binaries, unit tests, and examples, use the following:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>build
<span class="nb">cd</span><span class="w"> </span>build
cmake<span class="w"> </span>..<span class="w"> </span>-DSVS_BUILD_BINARIES<span class="o">=</span>YES<span class="w"> </span>-DSVS_BUILD_TESTS<span class="o">=</span>YES<span class="w"> </span>-DSVS_BUILD_EXAMPLES<span class="o">=</span>YES
cmake<span class="w"> </span>--build<span class="w"> </span>.<span class="w"> </span>-j<span class="k">$(</span>nproc<span class="k">)</span>
</pre></div>
</div>
</section>
</section>
<section id="build-options">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Build Options</a><a class="headerlink" href="#build-options" title="Link to this heading">ÔÉÅ</a></h2>
<p>SVS supports the following build-time options.</p>
<table class="docutils align-default" id="id2" style="width: 100">
<caption><span class="caption-text">SVS CMake variables</span><a class="headerlink" href="#id2" title="Link to this table">ÔÉÅ</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>CMake Option</p></th>
<th class="head"><p>Supported Values
(defaults in bold)</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SVS_BUILD_BINARIES</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>Build utility binaries.</p></td>
</tr>
<tr class="row-odd"><td><p>SVS_BUILD_TESTS</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>Build the unit test suite.</p></td>
</tr>
<tr class="row-even"><td><p>SVS_BUILD_BENCHMARK</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>Build the regression benchmarking suite.</p></td>
</tr>
<tr class="row-odd"><td><p>SVS_BUILD_DOCS</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>Build the documentation.</p></td>
</tr>
<tr class="row-even"><td><p>SVS_BUILD_EXAMPLES</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>Build the documentation examples.</p></td>
</tr>
<tr class="row-odd"><td><p>SVS_NO_AVX512</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>Disable Intel(R) AVX-512 instructions
from being used.
Helpful when running Valgrind as that tool
does not support Intel(R) AVX-512.</p>
<p>This option is not required when compiling on
non-Intel(R) AVX-512 systems.</p>
</td>
</tr>
</tbody>
</table>
<p>Occasionally, more control over the compiled binaries and executables is desired (to aid binary size and compilation time).
These fine-grained variables are defined below.</p>
<table class="docutils align-default" id="id3" style="width: 100">
<caption><span class="caption-text">Advanced SVS CMake Variables</span><a class="headerlink" href="#id3" title="Link to this table">ÔÉÅ</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>CMake Option</p></th>
<th class="head"><p>Supported Values
(defaults in bold)</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SVS_INITIALIZE_LOGGER</p></td>
<td><p><strong>ON</strong>, OFF</p></td>
<td><p>Enable the default SVS logger using the
environment variable SVS_LOG_LEVEL and
SVS_LOG_SINK (if they are defined).</p>
<p>If disabled, the default SVS logger will be
a null logger propagating no logging mesasges.</p>
</td>
</tr>
<tr class="row-odd"><td><p>SVS_FORCE_INTEGRATION_TESTS</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>By default, integration tests will not be
compiled when building in tests in debug mode
because debug builds of SVS are extremely
slow.</p>
<p>Setting this variable equal forces inclusion
of integration tests in the test binary.</p>
<p>This variable has no effect if
<code class="docutils literal notranslate"><span class="pre">SVS_BUILD_TESTS</span> <span class="pre">==</span> <span class="pre">OFF</span></code>.</p>
</td>
</tr>
<tr class="row-even"><td><p>SVS_BUILD_BENCHMARK_TEST_GENERATORS</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>Build the routines that generate
<a class="reference internal" href="../cpp/testing.html#testing"><span class="std std-ref">reference</span></a> results for
integration tests.</p>
<p>This is left off be default to reduce compile
times for the benchmark suite.</p>
</td>
</tr>
<tr class="row-odd"><td><p>SVS_EXPERIMENTAL_BUILD_CUSTOM_MKL</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>If the included modules have Intel(R) MKL has
a dependency, this option will create
a custom Intel(R) MKL shared-library using
only the symbols needed by SVS.</p>
<p>This allows for compiled SVS executables to
be portable.</p>
</td>
</tr>
</tbody>
</table>
<p>The following variables can be found in CMake files but are intended for development and debug purposes.
As such, they are subject to change without notice.
Please avoid using them.</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>SVS_EXPERIMENTAL_CHECK_BOUNDS</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>Enable bounds checking on some data structure
accesses. Can be helpful for debugging
out-of-bounds accesses.</p></td>
</tr>
<tr class="row-even"><td><p>SVS_EXPERIMENTAL_CLANG_TIDY</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>Enable the clang-tidy static analyzer on the
utility binaries.</p>
<p>Requires <code class="docutils literal notranslate"><span class="pre">SVS_BUILD_BINARIES=ON</span></code> to be
effective.</p>
</td>
</tr>
<tr class="row-odd"><td><p>SVS_EXPERIMENTAL_LEANVEC</p></td>
<td><p>ON, <strong>OFF</strong></p></td>
<td><p>Enable LeanVec for vector dimension reduction
Requires Intel(R) MKL library to implement SVD/GEMM</p></td>
</tr>
</tbody>
</table>
<section id="details-on-multi-arch-support">
<h3>Details on multi-arch support<a class="headerlink" href="#details-on-multi-arch-support" title="Link to this heading">ÔÉÅ</a></h3>
<p>The cibuildwheel environment sets the <code class="docutils literal notranslate"><span class="pre">SVS_MULTIARCH</span></code> environment variable before triggering the build of the library.
The file <code class="docutils literal notranslate"><span class="pre">bindings/python/setup.py</span></code> file observes this variable and passes a list of micro-architectures to the CMake build system.
CMake will then compiler a version of the backend shared library for each given micro-architecture using that micro-architecture name as a suffix.
At run-time, the Python library will detect the CPU it is currently running on and attempt to load the most compatible shared libary.
See <a class="reference internal" href="../python/backend.html#python-backend"><span class="std std-ref">this section</span></a> for details on backend inspection and selection.</p>
</section>
</section>
<section id="advanced-building-the-documentation">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">(Advanced) Building the Documentation</a><a class="headerlink" href="#advanced-building-the-documentation" title="Link to this heading">ÔÉÅ</a></h2>
<p>Library documentation is generated using <a class="reference external" href="https://www.doxygen.nl/">doxygen</a> to generate documentation for C++ code and <a class="reference external" href="https://www.sphinx-doc.org/en/master/">sphinx</a> to generate Python documentation and assemble the final website.</p>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">ÔÉÅ</a></h3>
<p>The following prerequisites are required:</p>
<ul class="simple">
<li><p>Python documentation dependencies. These can be installed using</p></li>
</ul>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>-r<span class="w"> </span>docs/requirements.txt
</pre></div>
</div>
<ul class="simple">
<li><p>Doxygen version 1.9.2 or higher (for C++ 20 support).
Precompiled binaries are available <a class="reference external" href="https://www.doxygen.nl/download.html">at this link</a>.</p></li>
<li><p>The svs <a class="reference internal" href="#building-python-library"><span class="std std-ref">Python module</span></a> built and installed.</p></li>
</ul>
</section>
<section id="building">
<h3>Building<a class="headerlink" href="#building" title="Link to this heading">ÔÉÅ</a></h3>
<p>Run the following series of commands to set-up and build the documentation.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>build_doc<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>build_doc
cmake<span class="w"> </span>..<span class="w"> </span>-DSVS_BUILD_DOCS<span class="o">=</span>YES<span class="w"> </span>-DDoxygen_ROOT<span class="o">=</span><span class="s2">&quot;path/to/doxygen/bin&quot;</span>
make
</pre></div>
</div>
<p>Alternatively, if svs has been installed in a non-standard directory, the final command will be</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">PYTHONPATH</span><span class="o">=</span><span class="s2">&quot;path/to/svs/dir&quot;</span><span class="w"> </span>make
</pre></div>
</div>
</section>
</section>
<section id="advanced-intel-r-mkl-as-a-dependency">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">(Advanced) Intel(R) MKL as a Dependency</a><a class="headerlink" href="#advanced-intel-r-mkl-as-a-dependency" title="Link to this heading">ÔÉÅ</a></h2>
<p>Upcoming SVS features need to use functionality provided by Intel(R) MKL.
SVS can link with Intel(R) MKL in a number of ways.</p>
<p>First, if Intel(R) MKL is not needed, then compiled SVS artifacts should not try to link with Intel(R) MKL.
Second, a system Intel(R) MKL can be used with the combination:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>-DSVS_EXPERIMENTAL_LEANVEC<span class="o">=</span>YES
-DSVS_EXPERIMENTAL_BUILD_CUSTOM_MKL<span class="o">=</span>NO
</pre></div>
</div>
<p>Note that if this option is used, you <em>may</em> need to include appropriate environment variable
for SVS to find Intel(R) MKL at run time.</p>
<p>Finally, SVS can also build and link with a custom Intel(R) MKL shared library using the
<a class="reference external" href="https://www.intel.com/content/www/us/en/docs/onemkl/developer-guide-linux/2024-0/using-the-custom-shared-object-builder.html">custom shared object builder</a> .
To use this feature, provide the following variables to Cmake at configuration time:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>-DSVS_EXPERIMENTAL_LEANVEC<span class="o">=</span>YES
-DSVS_EXPERIMENTAL_BUILD_CUSTOM_MKL<span class="o">=</span>YES
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lowermem.html" class="btn btn-neutral float-left" title="Searching with a small memory footprint" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="graph_search.html" class="btn btn-neutral float-right" title="Graph-based similarity search" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Intel Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>